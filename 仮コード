----------------------------models\password_entry.dart----------------------------

// ファイルパス: lib/models/password_entry.dart
// 役割: パスワードエントリのデータ構造を定義

class PasswordEntry {
  final String id;
  final String serviceName;
  final String username;
  final String encryptedPassword;
  final DateTime createdAt;
  final DateTime? updatedAt;

  PasswordEntry({
    required this.id,
    required this.serviceName,
    required this.username,
    required this.encryptedPassword,
    required this.createdAt,
    this.updatedAt,
  });

  PasswordEntry copyWith({
    String? serviceName,
    String? username,
    String? encryptedPassword,
    DateTime? updatedAt,
  }) {
    return PasswordEntry(
      id: id,
      serviceName: serviceName ?? this.serviceName,
      username: username ?? this.username,
      encryptedPassword: encryptedPassword ?? this.encryptedPassword,
      createdAt: createdAt,
      updatedAt: updatedAt ?? DateTime.now(),
    );
  }

  @override
  String toString() {
    return 'PasswordEntry(service: $serviceName, user: $username, encrypted: $encryptedPassword)';
  }
}

----------------------------providers\auth_provider.dart----------------------------

// ファイルパス: lib/providers/auth_provider.dart
// 役割: アプリケーション全体の認証状態（ロック/ロック解除）を管理する

import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'master_pin_provider.dart';

class AuthNotifier extends StateNotifier<bool> {
	AuthNotifier() : super(false); 

	void authenticate() {
		state = true;
	}

	void lockApp() {
		state = false;
	}
}

final authProvider = StateNotifierProvider<AuthNotifier, bool>(
	(ref) => AuthNotifier(),
);

final isSetupCompleteProvider = Provider<bool>((ref) {
	return ref.watch(masterPinProvider).isPinSet;
});

----------------------------providers\master_pin_provider.dart----------------------------

// ファイルパス: lib/providers/master_pin_provider.dart
// 役割: マスターPINの保存、認証ロジック、生体認証処理を管理する

import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:shared_preferences/shared_preferences.dart';
import 'package:local_auth/local_auth.dart';
import 'package:flutter/foundation.dart';
import 'auth_provider.dart';

class MasterPinState {
	final bool isPinSet;

	MasterPinState({required this.isPinSet});
}

final initialMasterPinState = MasterPinState(isPinSet: false);

class MasterPinNotifier extends StateNotifier<MasterPinState> {
	final Ref _ref; 
	final LocalAuthentication _localAuth = LocalAuthentication();
	static const _pinKey = 'masterPin';

	MasterPinNotifier(this._ref) : super(initialMasterPinState) {
		_loadPinStatus();
	}
	
	Future<void> _loadPinStatus() async {
		final prefs = await SharedPreferences.getInstance();
		final pin = prefs.getString(_pinKey);
		state = MasterPinState(isPinSet: pin != null && pin.isNotEmpty);
        if (state.isPinSet) {
             _ref.read(authProvider.notifier).lockApp();
        }
	}

	Future<void> setPin(String pin) async {
		final prefs = await SharedPreferences.getInstance();
		await prefs.setString(_pinKey, pin);
		state = MasterPinState(isPinSet: true);
		_ref.read(authProvider.notifier).authenticate(); 
	}
    
    Future<bool> checkCurrentPin(String pin) async {
        final prefs = await SharedPreferences.getInstance();
        final savedPin = prefs.getString(_pinKey);
        return savedPin == pin;
    }

	Future<bool> authenticate(String pin) async {
		final prefs = await SharedPreferences.getInstance();
		final savedPin = prefs.getString(_pinKey);

		if (savedPin == pin) {
			_ref.read(authProvider.notifier).authenticate(); 
			return true;
		}
		return false;
	}

	Future<bool> canAuthenticate() async {
		final canCheckBiometrics = await _localAuth.canCheckBiometrics;
		return canCheckBiometrics && await _localAuth.isDeviceSupported();
	}

	Future<bool> authenticateWithBiometrics() async {
		try {
			final authenticated = await _localAuth.authenticate(
				localizedReason: 'アプリをロック解除するために指紋または顔認証を行ってください',
				options: const AuthenticationOptions(
					stickyAuth: true,
					biometricOnly: true,
				),
			);
			
			if (authenticated) {
				_ref.read(authProvider.notifier).authenticate(); 
			}
			return authenticated;
		} catch (e) {
			debugPrint('生体認証エラー: $e');
			return false;
		}
	}
}

final masterPinProvider = StateNotifierProvider<MasterPinNotifier, MasterPinState>(
	(ref) {
		return MasterPinNotifier(ref);
	},
);

----------------------------providers\password_provider.dart----------------------------

// ファイルパス: lib/providers/password_provider.dart
// 役割: パスワードエントリのデータモデルと、エントリリストを管理するRiverpod Provider
// データはメモリ内にのみ保持されます (アプリ終了で消えます)

import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:uuid/uuid.dart';

const uuid = Uuid();

class PasswordEntry {
  final String id;
  final String title;
  final String username;
  final String password;
  final String url;
  final DateTime createdAt;

  PasswordEntry({
    required this.id,
    required this.title,
    required this.username,
    required this.password,
    this.url = '',
    required this.createdAt,
  });

  PasswordEntry copyWith({
    String? id,
    String? title,
    String? username,
    String? password,
    String? url,
    DateTime? createdAt,
  }) {
    return PasswordEntry(
      id: id ?? this.id,
      title: title ?? this.title,
      username: username ?? this.username,
      password: password ?? this.password,
      url: url ?? this.url,
      createdAt: createdAt ?? this.createdAt,
    );
  }
}

class PasswordListNotifier extends StateNotifier<List<PasswordEntry>> {
  PasswordListNotifier() : super([
    PasswordEntry(
      id: uuid.v4(),
      title: 'Google アカウント',
      username: 'user@gmail.com',
      password: 'password123',
      url: 'https://www.google.com',
      createdAt: DateTime.now().subtract(const Duration(days: 5)),
    ),
    PasswordEntry(
      id: uuid.v4(),
      title: 'GitHub',
      username: 'dev_user',
      password: 'secure_pass_hash',
      url: 'https://github.com',
      createdAt: DateTime.now().subtract(const Duration(days: 2)),
    ),
  ]);

  void addPassword(PasswordEntry entry) {
    state = [...state, entry];
  }

  void updatePassword(PasswordEntry updatedEntry) {
    state = [
      for (final entry in state)
        if (entry.id == updatedEntry.id) updatedEntry else entry,
    ];
  }

  void deletePassword(String id) {
    state = state.where((entry) => entry.id != id).toList();
  }
}

final passwordListProvider = 
    StateNotifierProvider<PasswordListNotifier, List<PasswordEntry>>((ref) {
  return PasswordListNotifier();
});

----------------------------screens\add_password_screen.dart----------------------------

// ファイルパス: lib/screens/add_password_screen.dart
// 役割: 新しいパスワード情報を入力し、保存するための画面

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:uuid/uuid.dart';
import '../providers/password_provider.dart'; 

const uuid = Uuid();

class AddPasswordScreen extends ConsumerWidget {
  const AddPasswordScreen({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final serviceController = TextEditingController();
    final usernameController = TextEditingController();
    final passwordController = TextEditingController();
    final urlController = TextEditingController(); 

    final formKey = GlobalKey<FormState>();

    void saveNewEntry() {
      if (formKey.currentState!.validate()) {
        final newEntry = PasswordEntry(
          id: uuid.v4(),
          title: serviceController.text, 
          username: usernameController.text, 
          password: passwordController.text, 
          url: urlController.text,
          createdAt: DateTime.now(),
        );

        ref.read(passwordListProvider.notifier).addPassword(newEntry);

        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(content: Text('${newEntry.title} をリストに追加しました。')),
        );
        Navigator.of(context).pop();
      }
    }

    return Scaffold(
      appBar: AppBar(
        title: const Text('新しいパスワードを追加'),
        backgroundColor: Theme.of(context).colorScheme.primary,
        foregroundColor: Colors.white,
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(20.0),
        child: Form(
          key: formKey,
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.start,
            children: [
              _buildTextField(
                controller: serviceController, 
                label: 'サービス名 / ウェブサイト (必須)', 
                icon: Icons.title,
                validator: (value) => value!.isEmpty ? 'タイトルは必須です' : null,
              ),
              const SizedBox(height: 20),

              _buildTextField(
                controller: usernameController, 
                label: 'ユーザー名 / メールアドレス', 
                icon: Icons.person,
              ),
              const SizedBox(height: 20),

              _buildPasswordField(
                controller: passwordController,
                validator: (value) => value!.isEmpty ? 'パスワードは必須です' : null,
              ),
              const SizedBox(height: 20),

              _buildTextField(
                controller: urlController, 
                label: 'URL', 
                icon: Icons.link, 
                keyboardType: TextInputType.url,
              ),
              const SizedBox(height: 30),

              SizedBox(
                width: double.infinity,
                child: ElevatedButton.icon(
                  onPressed: saveNewEntry,
                  icon: const Icon(Icons.save),
                  label: const Text('保存', style: TextStyle(fontSize: 18)),
                  style: ElevatedButton.styleFrom(
                    padding: const EdgeInsets.symmetric(vertical: 15),
                    backgroundColor: Theme.of(context).colorScheme.secondary,
                    foregroundColor: Colors.white,
                    shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(10)),
                  ),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }

  Widget _buildTextField({
    required TextEditingController controller, 
    required String label, 
    required IconData icon, 
    int maxLines = 1,
    TextInputType keyboardType = TextInputType.text,
    String? Function(String?)? validator,
  }) {
    return TextFormField(
      controller: controller,
      maxLines: maxLines,
      keyboardType: keyboardType,
      validator: validator,
      decoration: InputDecoration(
        labelText: label,
        prefixIcon: Icon(icon),
        border: OutlineInputBorder(
          borderRadius: BorderRadius.circular(10),
        ),
        filled: true,
        fillColor: Colors.white,
      ),
    );
  }

  Widget _buildPasswordField({
    required TextEditingController controller,
    String? Function(String?)? validator,
  }) {
    return TextFormField(
      controller: controller,
      obscureText: true,
      validator: validator,
      decoration: InputDecoration(
        labelText: 'パスワード (必須)',
        prefixIcon: const Icon(Icons.vpn_key),
        border: OutlineInputBorder(
          borderRadius: BorderRadius.circular(10),
        ),
        filled: true,
        fillColor: Colors.white,
      ),
    );
  }
}

----------------------------screens\auth_screen.dart----------------------------

// ファイルパス: lib/screens/auth_screen.dart
// 役割: アプリケーションの認証フローを処理（マスターPINの設定・入力・生体認証）

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../providers/master_pin_provider.dart';

class AuthScreen extends ConsumerStatefulWidget {
	const AuthScreen({super.key});

	@override
	ConsumerState<AuthScreen> createState() => _AuthScreenState();
}

class _AuthScreenState extends ConsumerState<AuthScreen> {
	final _pinController = TextEditingController();
	final _confirmPinController = TextEditingController();
	String _errorMessage = '';
	
	bool _isSettingPinMode = false; 
	bool _isBiometricsAvailable = false; 
	bool _isLoading = false; 

	@override
	void initState() {
		super.initState();
		_checkBiometrics(); 
	}
	
	@override
	void dispose() {
		_pinController.dispose();
		_confirmPinController.dispose();
		super.dispose();
	}

	Future<void> _checkBiometrics() async {
		final available = await ref.read(masterPinProvider.notifier).canAuthenticate();
		if (mounted) {
			setState(() {
				_isBiometricsAvailable = available;
			});
		}
	}

	void _submitSetPin() {
		final pin = _pinController.text;
		final confirmPin = _confirmPinController.text;

		if (pin.length != 4) {
			setState(() => _errorMessage = 'PINは4桁の数字で入力してください。');
			return;
		}

		if (pin != confirmPin) {
			setState(() => _errorMessage = '確認用PINが一致しません。');
			return;
		}
		
		ref.read(masterPinProvider.notifier).setPin(pin);
		
		setState(() {
			_errorMessage = '';
			_isSettingPinMode = false; 
			_pinController.clear(); 
			_confirmPinController.clear();
		});
	}

	Future<void> _submitAuthenticate() async {
		if (_isLoading) return; 
		
		final pin = _pinController.text;

		if (pin.length != 4) {
			setState(() => _errorMessage = 'PINは4桁の数字で入力してください。');
			return;
		}
		
		setState(() {
			_isLoading = true;
			_errorMessage = '';
		});
		
		final isSuccess = await ref.read(masterPinProvider.notifier).authenticate(pin);

		if (mounted) {
			setState(() {
				_isLoading = false;
				
				if (isSuccess) { 
					_pinController.clear();
					_errorMessage = ''; 
				} else {
					_errorMessage = 'PINが間違っています。';
				}
			});
		}
	}

	Future<void> _authenticateWithBiometrics() async {
		setState(() => _errorMessage = '');
		final success = await ref.read(masterPinProvider.notifier).authenticateWithBiometrics();
		
		if (!success) {
			setState(() => _errorMessage = '生体認証に失敗しました。PINを入力してください。');
		} else {
			setState(() => _errorMessage = '');
		}
	}

	@override
	Widget build(BuildContext context) {
		final masterPinState = ref.watch(masterPinProvider);
		final isPinSet = masterPinState.isPinSet;
		
		final currentModeIsSetting = !isPinSet || _isSettingPinMode;
		
		final buttonAction = _isLoading 
			? null 
			: (currentModeIsSetting ? _submitSetPin : _submitAuthenticate);

		final theme = Theme.of(context);
		final title = currentModeIsSetting 
				? '新しいマスターPINを設定' 
				: 'マスターPINを入力してロック解除';
			
		final buttonText = currentModeIsSetting ? 'PINを設定して開始' : 'ロック解除';

		return Scaffold(
			body: Center(
				child: SingleChildScrollView(
					padding: const EdgeInsets.all(32.0),
					child: Column(
						mainAxisAlignment: MainAxisAlignment.center,
						crossAxisAlignment: CrossAxisAlignment.stretch,
						children: <Widget>[
							Icon(Icons.lock_person, size: 80, color: theme.colorScheme.primary),
							const SizedBox(height: 16),

							Text(
								title,
								style: theme.textTheme.headlineMedium?.copyWith(
									fontWeight: FontWeight.bold,
									color: theme.colorScheme.primary,
								),
								textAlign: TextAlign.center,
							),
							const SizedBox(height: 32),
					
							TextField(
								controller: _pinController,
								obscureText: true,
								keyboardType: TextInputType.number,
								maxLength: 4,
								textAlign: TextAlign.center,
								style: const TextStyle(fontSize: 24, letterSpacing: 8),
								decoration: InputDecoration(
									labelText: currentModeIsSetting ? '4桁の新しいPIN' : 'PINコード',
									counterText: '',
									border: const OutlineInputBorder(borderRadius: BorderRadius.all(Radius.circular(12))),
									prefixIcon: const Icon(Icons.vpn_key),
								),
							),
							const SizedBox(height: 16),
							
							if (currentModeIsSetting) ...[ 
								TextField(
									controller: _confirmPinController,
									obscureText: true,
									keyboardType: TextInputType.number,
									maxLength: 4,
									textAlign: TextAlign.center,
									style: const TextStyle(fontSize: 24, letterSpacing: 8),
									decoration: const InputDecoration(
										labelText: '確認用PINコード',
										counterText: '',
										border: OutlineInputBorder(borderRadius: BorderRadius.all(Radius.circular(12))),
										prefixIcon: Icon(Icons.check_circle_outline),
									),
								),
								const SizedBox(height: 32),
							],
							
							currentModeIsSetting ? const SizedBox.shrink() : const SizedBox(height: 16),


							if (_errorMessage.isNotEmpty)
								Padding(
									padding: const EdgeInsets.only(bottom: 16),
									child: Text(
										_errorMessage,
										style: const TextStyle(color: Colors.red, fontWeight: FontWeight.bold),
										textAlign: TextAlign.center,
									),
								),

							ElevatedButton(
								onPressed: buttonAction,
								style: ElevatedButton.styleFrom(
									minimumSize: const Size(double.infinity, 50),
									backgroundColor: theme.colorScheme.primary,
									foregroundColor: theme.colorScheme.onPrimary,
									shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(8)),
									elevation: 4,
								),
								child: _isLoading 
									? const SizedBox(
										width: 24,
										height: 24,
										child: CircularProgressIndicator(color: Colors.white, strokeWidth: 3),
									  )
									: Text(buttonText, style: const TextStyle(fontSize: 16, fontWeight: FontWeight.bold)),
							),

							if (isPinSet && !currentModeIsSetting && _isBiometricsAvailable)
								Padding(
									padding: const EdgeInsets.only(top: 24),
									child: Column(
										children: [
											const Divider(height: 32),
											
											IconButton(
												icon: const Icon(Icons.fingerprint, size: 56),
												onPressed: _isLoading ? null : _authenticateWithBiometrics,
												tooltip: '指紋/顔認証でロック解除',
												color: theme.colorScheme.secondary,
											),
											const SizedBox(height: 8),
											Text('または 生体認証で解除', style: TextStyle(color: theme.colorScheme.secondary)),
										],
									),
								),

							if (isPinSet && !currentModeIsSetting)
								Padding(
									padding: const EdgeInsets.only(top: 24.0),
									child: TextButton(
										onPressed: _isLoading ? null : () {
											setState(() {
												_isSettingPinMode = true;
												_errorMessage = '';
												_pinController.clear();
												_confirmPinController.clear();
											});
										},
										child: const Text('PINを再設定する'),
									),
								),
						],
					),
				),
			),
		);
	}
}

----------------------------screens\edit_screen.dart----------------------------

// ファイルパス: lib/screens/edit_screen.dart
// 役割: 既存のパスワードエントリの詳細表示と編集

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../providers/password_provider.dart';

class EditPasswordScreen extends ConsumerStatefulWidget {
  final PasswordEntry entry;
  
  const EditPasswordScreen({required this.entry, super.key});

  @override
  ConsumerState<EditPasswordScreen> createState() => _EditPasswordScreenState();
}

class _EditPasswordScreenState extends ConsumerState<EditPasswordScreen> {
  late TextEditingController _titleController;
  late TextEditingController _usernameController;
  late TextEditingController _passwordController;
  late TextEditingController _urlController;
  
  final _formKey = GlobalKey<FormState>();
  
  bool _isPasswordVisible = false;

  @override
  void initState() {
    super.initState();
    _titleController = TextEditingController(text: widget.entry.title);
    _usernameController = TextEditingController(text: widget.entry.username);
    _passwordController = TextEditingController(text: widget.entry.password);
    _urlController = TextEditingController(text: widget.entry.url);
  }

  @override
  void dispose() {
    _titleController.dispose();
    _usernameController.dispose();
    _passwordController.dispose();
    _urlController.dispose();
    super.dispose();
  }

  void _saveEntry() {
    if (_formKey.currentState!.validate()) {
      final updatedEntry = widget.entry.copyWith(
        title: _titleController.text,
        username: _usernameController.text,
        password: _passwordController.text,
        url: _urlController.text,
      );
      
      ref.read(passwordListProvider.notifier).updatePassword(updatedEntry); 

      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('パスワードエントリを更新しました。')),
      );
      Navigator.of(context).pop();
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('${widget.entry.title} の編集'),
        backgroundColor: Theme.of(context).colorScheme.primary,
        foregroundColor: Theme.of(context).colorScheme.onPrimary,
        actions: [
          IconButton(
            onPressed: _saveEntry,
            icon: const Icon(Icons.save),
            tooltip: '保存',
          )
        ],
      ),
      body: SingleChildScrollView(
        padding: const EdgeInsets.all(16.0),
        child: Form(
          key: _formKey,
          child: Column(
            crossAxisAlignment: CrossAxisAlignment.stretch,
            children: [
              TextFormField(
                controller: _titleController,
                decoration: const InputDecoration(
                  labelText: 'タイトル (例: Google, 銀行)',
                  prefixIcon: Icon(Icons.title),
                ),
                validator: (value) {
                  if (value == null || value.isEmpty) {
                    return 'タイトルは必須です';
                  }
                  return null;
                },
              ),
              const SizedBox(height: 20),

              TextFormField(
                controller: _usernameController,
                decoration: const InputDecoration(
                  labelText: 'ユーザー名 / メールアドレス',
                  prefixIcon: Icon(Icons.person),
                ),
              ),
              const SizedBox(height: 20),

              TextFormField(
                controller: _passwordController,
                obscureText: !_isPasswordVisible,
                decoration: InputDecoration(
                  labelText: 'パスワード',
                  prefixIcon: const Icon(Icons.lock),
                  suffixIcon: IconButton(
                    icon: Icon(
                      _isPasswordVisible ? Icons.visibility : Icons.visibility_off,
                    ),
                    onPressed: () {
                      setState(() {
                        _isPasswordVisible = !_isPasswordVisible;
                      });
                    },
                  ),
                ),
                validator: (value) {
                  if (value == null || value.isEmpty) {
                    return 'パスワードは必須です';
                  }
                  return null;
                },
              ),
              const SizedBox(height: 20),

              TextFormField(
                controller: _urlController,
                decoration: const InputDecoration(
                  labelText: 'URL / ウェブサイト',
                  prefixIcon: Icon(Icons.link),
                ),
                keyboardType: TextInputType.url,
              ),

              const SizedBox(height: 30),

              ElevatedButton.icon(
                onPressed: _saveEntry,
                icon: const Icon(Icons.save),
                label: const Text('変更を保存'),
                style: ElevatedButton.styleFrom(
                  backgroundColor: Theme.of(context).colorScheme.secondary,
                  foregroundColor: Theme.of(context).colorScheme.onSecondary,
                  padding: const EdgeInsets.symmetric(vertical: 15),
                  textStyle: const TextStyle(fontSize: 16, fontWeight: FontWeight.bold),
                ),
              ),
            ],
          ),
        ),
      ),
    );
  }
}

----------------------------screens\generate_screen.dart----------------------------

// ファイルパス: lib/screens/generate_screen.dart
// 役割: パスワード生成の設定と実行、結果表示、クリップボードへのコピー

import 'package:flutter/material.dart';
import 'package:flutter/services.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../services/generator.dart';

class GenerationSettings {
  final int length;
  final bool useUpper;
  final bool useNumbers;
  final bool useSymbols;

  GenerationSettings({
    required this.length,
    required this.useUpper,
    required this.useNumbers,
    required this.useSymbols,
  });

  GenerationSettings copyWith({
    int? length,
    bool? useUpper,
    bool? useNumbers,
    bool? useSymbols,
  }) {
    return GenerationSettings(
      length: length ?? this.length,
      useUpper: useUpper ?? this.useUpper,
      useNumbers: useNumbers ?? this.useNumbers,
      useSymbols: useSymbols ?? this.useSymbols,
    );
  }
}

class GenerationSettingsNotifier extends StateNotifier<GenerationSettings> {
  GenerationSettingsNotifier()
      : super(
          GenerationSettings(
            length: 16,
            useUpper: true,
            useNumbers: true,
            useSymbols: true,
          ),
        );
  
  void setLength(int length) => state = state.copyWith(length: length);
  void setUseUpper(bool value) => state = state.copyWith(useUpper: value);
  void setUseNumbers(bool value) => state = state.copyWith(useNumbers: value);
  void setUseSymbols(bool value) => state = state.copyWith(useSymbols: value);
}

final generationSettingsProvider = StateNotifierProvider<GenerationSettingsNotifier, GenerationSettings>(
  (ref) => GenerationSettingsNotifier(),
);

final generatedPasswordProvider = StateProvider<String>((ref) => '');

class GenerateScreen extends ConsumerWidget {
  const GenerateScreen({super.key});

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final settings = ref.watch(generationSettingsProvider);
    final generatedPassword = ref.watch(generatedPasswordProvider);
    final settingsNotifier = ref.read(generationSettingsProvider.notifier);

    void generatePassword() {
      final newPassword = PasswordGeneratorService.generatePassword(
        length: settings.length,
        useUpper: settings.useUpper,
        useNumbers: settings.useNumbers,
        useSymbols: settings.useSymbols,
      );
      ref.read(generatedPasswordProvider.notifier).state = newPassword;
    }

    void copyToClipboard(String text) {
      Clipboard.setData(ClipboardData(text: text));
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('パスワードをクリップボードにコピーしました。')),
      );
    }

    return SingleChildScrollView(
      padding: const EdgeInsets.all(16.0),
      child: Column(
        crossAxisAlignment: CrossAxisAlignment.stretch,
        children: <Widget>[
          Card(
            elevation: 4,
            shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
            child: Padding(
              padding: const EdgeInsets.all(20.0),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.stretch,
                children: [
                  Text(
                    '生成されたパスワード',
                    style: Theme.of(context).textTheme.titleMedium,
                  ),
                  const SizedBox(height: 12),
                  Container(
                    padding: const EdgeInsets.symmetric(vertical: 16, horizontal: 12),
                    decoration: BoxDecoration(
                      color: Theme.of(context).colorScheme.primary.withAlpha(50), 
                      borderRadius: BorderRadius.circular(8),
                      border: Border.all(color: Theme.of(context).colorScheme.primary.withAlpha(100)),
                    ),
                    child: SelectableText(
                      generatedPassword.isEmpty ? '設定を確認し、「生成」ボタンを押してください。' : generatedPassword,
                      style: const TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
                      textAlign: TextAlign.center,
                    ),
                  ),
                  const SizedBox(height: 16),
                  
                  ElevatedButton.icon(
                    onPressed: generatedPassword.isEmpty ? null : () => copyToClipboard(generatedPassword),
                    icon: const Icon(Icons.copy),
                    label: const Text('クリップボードにコピー'),
                    style: ElevatedButton.styleFrom(
                      backgroundColor: generatedPassword.isEmpty 
                          ? Colors.grey 
                          : Theme.of(context).colorScheme.secondary,
                      foregroundColor: Colors.white,
                      minimumSize: const Size(double.infinity, 45),
                    ),
                  ),
                ],
              ),
            ),
          ),
          
          const SizedBox(height: 32),
          
          Text(
            '生成設定',
            style: Theme.of(context).textTheme.headlineSmall,
          ),
          const Divider(height: 16),

          Card(
            child: Padding(
              padding: const EdgeInsets.all(16.0),
              child: Column(
                crossAxisAlignment: CrossAxisAlignment.start,
                children: [
                  Text('パスワードの長さ: ${settings.length} 文字', style: Theme.of(context).textTheme.titleMedium),
                  Slider(
                    value: settings.length.toDouble(),
                    min: 8,
                    max: 32,
                    divisions: 24,
                    label: settings.length.toString(),
                    onChanged: (double value) {
                      settingsNotifier.setLength(value.round());
                    },
                  ),
                ],
              ),
            ),
          ),
          
          const SizedBox(height: 16),

          Card(
            child: Column(
              children: [
                SwitchListTile(
                  title: const Text('大文字 (A-Z)'),
                  value: settings.useUpper,
                  onChanged: (bool value) {
                    settingsNotifier.setUseUpper(value);
                  },
                ),
                SwitchListTile(
                  title: const Text('数字 (0-9)'),
                  value: settings.useNumbers,
                  onChanged: (bool value) {
                    settingsNotifier.setUseNumbers(value);
                  },
                ),
                SwitchListTile(
                  title: const Text('記号 (!@#\$...)'), 
                  value: settings.useSymbols, 
                  onChanged: (bool value) {
                    settingsNotifier.setUseSymbols(value);
                  },
                ),
                const ListTile(
                  title: Text('小文字 (a-z)'),
                  trailing: Icon(Icons.check_circle, color: Colors.green),
                  subtitle: Text('セキュリティのため常に含まれます'),
                ),
              ],
            ),
          ),
          
          const SizedBox(height: 32),
          
          ElevatedButton.icon(
            onPressed: generatePassword,
            icon: const Icon(Icons.security),
            label: const Text('強力なパスワードを生成'),
            style: ElevatedButton.styleFrom(
              backgroundColor: Theme.of(context).colorScheme.tertiary,
              foregroundColor: Theme.of(context).colorScheme.onTertiary,
              minimumSize: const Size(double.infinity, 60),
              shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(12)),
              textStyle: const TextStyle(fontSize: 18, fontWeight: FontWeight.bold),
            ),
          ),
        ],
      ),
    );
  }
}

----------------------------screens\home_screen.dart----------------------------

// ファイルパス: lib/screens/home_screen.dart
// 役割: メインコンテンツ画面（TabBarとAppBarを含む）。AuthWrapperから分離されたもの。

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../providers/auth_provider.dart'; 
import 'password_list_screen.dart';
import 'generate_screen.dart';
import 'add_password_screen.dart';
import 'settings_screen.dart';

class HomeScreen extends ConsumerWidget {
	const HomeScreen({super.key});

	void _navigateToAddPasswordScreen(BuildContext context) {
		Navigator.of(context).push(
			MaterialPageRoute(
				builder: (context) => const AddPasswordScreen(),
			),
		);
	}
	
	void _navigateToSettingsScreen(BuildContext context) {
		Navigator.of(context).push(
			MaterialPageRoute(
				builder: (context) => const SettingsScreen(),
			),
		);
	}

	@override
	Widget build(BuildContext context, WidgetRef ref) {
		void lockApp() {
			ref.read(authProvider.notifier).lockApp();
		}
		
		final theme = Theme.of(context);

		return DefaultTabController(
			key: const ValueKey('MainAppScreen'),
			length: 2,
			child: Builder(
				builder: (context) {
					final TabController tabController = DefaultTabController.of(context);
					
					return ListenableBuilder(
						listenable: tabController,
						builder: (context, child) {
							final int currentIndex = tabController.index; 
							
							return Scaffold(
								appBar: AppBar( 
									title: const Text('パスワードマネージャー'), 
									backgroundColor: theme.colorScheme.primary,
									foregroundColor: Colors.white,
									actions: [
										IconButton(
											icon: const Icon(Icons.settings),
											tooltip: '設定',
											onPressed: () => _navigateToSettingsScreen(context),
										),
										IconButton(
											icon: const Icon(Icons.lock_outline),
											tooltip: 'アプリをロック',
											onPressed: lockApp, 
										),
									],
									bottom: const TabBar(
										labelColor: Colors.white,
										unselectedLabelColor: Colors.white70,
										tabs: [
											Tab(icon: Icon(Icons.lock_open), text: 'パスワード管理'),
											Tab(icon: Icon(Icons.vpn_key), text: 'パスワード生成'),
										],
									),
								),
								body: const TabBarView(
									children: [
										PasswordListScreen(), 
										GenerateScreen(),
									],
								),
								
								floatingActionButton: currentIndex == 0
									? FloatingActionButton(
										heroTag: 'addPasswordButtonHome',
										onPressed: () => _navigateToAddPasswordScreen(context),
										tooltip: 'パスワードを追加',
										child: const Icon(Icons.add),
									)
									: null,
							);
						}
					);
				}
			),
		);
	}
}

----------------------------screens\password_list_screen.dart----------------------------

// ファイルパス: lib/screens/password_list_screen.dart
// 役割: パスワード一覧を表示し、新しいパスワードを追加する機能を提供する

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'package:flutter/services.dart'; 
import 'add_password_screen.dart';
import 'edit_screen.dart';
import '../providers/password_provider.dart';

class PasswordListScreen extends ConsumerWidget {
  const PasswordListScreen({super.key});

  void _navigateToAddPasswordScreen(BuildContext context) {
    Navigator.of(context).push(
      MaterialPageRoute(
        builder: (context) => const AddPasswordScreen(),
      ),
    );
  }

  void _navigateToEditPasswordScreen(BuildContext context, PasswordEntry entry) {
    Navigator.of(context).push(
      MaterialPageRoute(
        builder: (context) => EditPasswordScreen(entry: entry),
      ),
    );
  }

  void _copyToClipboard(BuildContext context, String text, String title) {
    if (text.isEmpty) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('パスワードが空です。')),
      );
      return;
    }

    Clipboard.setData(ClipboardData(text: text));
    
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('$title のパスワードをコピーしました。')),
    );
  }


  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final passwordList = ref.watch(passwordListProvider);

    Widget content;

    if (passwordList.isEmpty) {
      content = const Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            Icon(Icons.lock_open, size: 60, color: Colors.grey),
            SizedBox(height: 10),
            Text(
              'まだパスワードが登録されていません。', 
              style: TextStyle(fontSize: 16, color: Colors.grey),
            ),
            Text(
              '右下のボタンから追加してください。', 
              style: TextStyle(fontSize: 16, color: Colors.grey),
            ),
          ],
        ),
      );
    } else {
      content = ListView.builder(
        itemCount: passwordList.length,
        itemBuilder: (ctx, index) {
          final entry = passwordList[index];
          return Card(
            margin: const EdgeInsets.symmetric(horizontal: 10, vertical: 6),
            child: ListTile(
              leading: const Icon(Icons.vpn_key, color: Colors.blueGrey),
              title: Text(
                entry.title, 
                style: const TextStyle(fontWeight: FontWeight.bold),
              ),
              subtitle: Text(entry.username.isNotEmpty 
                  ? entry.username 
                  : entry.url.split('/').last),
              
              trailing: Row(
                mainAxisSize: MainAxisSize.min,
                children: [
                  IconButton(
                    icon: const Icon(Icons.copy, size: 20, color: Colors.grey),
                    onPressed: () {
                      _copyToClipboard(context, entry.password, entry.title); 
                    },
                    tooltip: 'パスワードをコピー',
                  ),
                  IconButton(
                    icon: const Icon(Icons.edit_note, size: 24, color: Colors.blueGrey),
                    onPressed: () {
                      _navigateToEditPasswordScreen(context, entry); 
                    },
                    tooltip: '編集',
                  ),
                ],
              ),
              
              onTap: () {
                _navigateToEditPasswordScreen(context, entry);
              },
              
              onLongPress: () {
                ref.read(passwordListProvider.notifier).deletePassword(entry.id); 
                ScaffoldMessenger.of(context).showSnackBar(
                  SnackBar(content: Text('${entry.title} を削除しました。')),
                );
              },
            ),
          );
        },
      );
    }

    return Scaffold(
      body: content,
      
      floatingActionButton: FloatingActionButton(
        onPressed: () => _navigateToAddPasswordScreen(context), 
        tooltip: '新しいパスワードを追加',
        child: const Icon(Icons.add),
      ),
    );
  }
}

----------------------------screens\settings_screen.dart----------------------------

// ファイルパス: lib/screens/settings_screen.dart
// 役割: 設定画面。PINの変更やログアウト（ロック）機能を提供する。

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../providers/master_pin_provider.dart';
import '../providers/auth_provider.dart';

class SettingsScreen extends ConsumerStatefulWidget {
    const SettingsScreen({super.key});

    @override
    ConsumerState<SettingsScreen> createState() => _SettingsScreenState();
}

class _SettingsScreenState extends ConsumerState<SettingsScreen> {
    final _currentPinController = TextEditingController();
    final _newPinController = TextEditingController();
    final _confirmNewPinController = TextEditingController();
    String _pinMessage = '';
    
    bool get isAuthenticated => ref.watch(authProvider);

    Future<void> _changePin() async {
        final currentPin = _currentPinController.text;
        final newPin = _newPinController.text;
        final confirmPin = _confirmNewPinController.text;
        
        if (newPin.length != 4 || confirmPin.length != 4) {
            setState(() => _pinMessage = '新しいPINは4桁の数字で入力してください。');
            return;
        }

        if (newPin != confirmPin) {
            setState(() => _pinMessage = '新しいPINと確認用PINが一致しません。');
            return;
        }
        
        final notifier = ref.read(masterPinProvider.notifier);
        
        final isCurrentPinValid = await notifier.checkCurrentPin(currentPin);
        
        if (!isCurrentPinValid) {
            setState(() => _pinMessage = '現在のPINが間違っています。');
            return;
        }

        await notifier.setPin(newPin); 

        setState(() {
            _pinMessage = 'PINが正常に更新されました！';
            _currentPinController.clear();
            _newPinController.clear();
            _confirmNewPinController.clear();
        });
    }

    void _logout() {
        ref.read(authProvider.notifier).lockApp();
        Navigator.of(context).pop();
    }

    @override
    void dispose() {
        _currentPinController.dispose();
        _newPinController.dispose();
        _confirmNewPinController.dispose();
        super.dispose();
    }

    @override
    Widget build(BuildContext context) {
        final theme = Theme.of(context);
        
        return Scaffold(
            appBar: AppBar(
                title: const Text('設定'),
                backgroundColor: theme.colorScheme.primary,
                foregroundColor: Colors.white,
            ),
            body: SingleChildScrollView(
                padding: const EdgeInsets.all(16.0),
                child: Column(
                    crossAxisAlignment: CrossAxisAlignment.start,
                    children: [
                        Text(
                            'マスターPINの変更',
                            style: theme.textTheme.headlineSmall?.copyWith(fontWeight: FontWeight.bold),
                        ),
                        const Divider(height: 32),

                        TextField(
                            controller: _currentPinController,
                            obscureText: true,
                            keyboardType: TextInputType.number,
                            maxLength: 4, 
                            decoration: const InputDecoration(
                                labelText: '現在のPIN (4桁)',
                                counterText: '',
                            ),
                        ),
                        const SizedBox(height: 16),
                        
                        TextField(
                            controller: _newPinController,
                            obscureText: true,
                            keyboardType: TextInputType.number,
                            maxLength: 4, 
                            decoration: const InputDecoration(
                                labelText: '新しいPIN (4桁)',
                                counterText: '',
                            ),
                        ),
                        const SizedBox(height: 16),

                        TextField(
                            controller: _confirmNewPinController,
                            obscureText: true,
                            keyboardType: TextInputType.number,
                            maxLength: 4, 
                            decoration: const InputDecoration(
                                labelText: '新しいPIN (確認)',
                                counterText: '',
                            ),
                        ),
                        const SizedBox(height: 24),
                        
                        if (_pinMessage.isNotEmpty)
                            Padding(
                                padding: const EdgeInsets.only(bottom: 16),
                                child: Text(
                                    _pinMessage,
                                    style: TextStyle(color: _pinMessage.contains('正常') ? Colors.green : Colors.red, fontWeight: FontWeight.bold),
                                ),
                            ),

                        ElevatedButton(
                            onPressed: _changePin,
                            style: ElevatedButton.styleFrom(
                                minimumSize: const Size(double.infinity, 50),
                                backgroundColor: theme.colorScheme.secondary,
                                foregroundColor: theme.colorScheme.onSecondary,
                            ),
                            child: const Text('PINを変更する'),
                        ),
                        
                        const SizedBox(height: 40),

                        Text(
                            'セキュリティ',
                            style: theme.textTheme.headlineSmall?.copyWith(fontWeight: FontWeight.bold),
                        ),
                        const Divider(height: 32),
                        
                        ListTile(
                            title: const Text('アプリをロック'),
                            subtitle: const Text('すぐに認証画面に戻ります'),
                            trailing: const Icon(Icons.lock_outline, color: Colors.grey),
                            onTap: _logout,
                        ),
                    ],
                ),
            ),
        );
    }
}

----------------------------screens\setup_screen.dart----------------------------

// ファイルパス: lib/screens/setup_screen.dart
// 役割: 初回起動時のセットアップ（ここではマスターPIN設定を兼ねる）

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import '../providers/master_pin_provider.dart';

class SetupScreen extends ConsumerStatefulWidget {
	const SetupScreen({super.key});

	@override
	ConsumerState<SetupScreen> createState() => _SetupScreenState();
}

class _SetupScreenState extends ConsumerState<SetupScreen> {
	final _pinController = TextEditingController();
	final _confirmPinController = TextEditingController();
	String _errorMessage = '';
	bool _isLoading = false;

	@override
	void dispose() {
		_pinController.dispose();
		_confirmPinController.dispose();
		super.dispose();
	}

	void _submitPinSetup() {
		if (_isLoading) return;

		final pin = _pinController.text;
		final confirmPin = _confirmPinController.text;

		if (pin.length != 4) {
			setState(() => _errorMessage = 'PINは4桁の数字で入力してください。');
			return;
		}

		if (pin != confirmPin) {
			setState(() => _errorMessage = '確認用PINが一致しません。');
			return;
		}
		
		setState(() {
			_isLoading = true;
			_errorMessage = '';
		});

		try {
			ref.read(masterPinProvider.notifier).setPin(pin);
			
		} catch (e) {
			setState(() => _errorMessage = 'PIN設定中にエラーが発生しました: $e');
		} finally {
			if(mounted) {
                setState(() => _isLoading = false);
            }
		}
	}

	@override
	Widget build(BuildContext context) {
		final theme = Theme.of(context);
		
		return Scaffold(
			body: Center(
				child: SingleChildScrollView(
					padding: const EdgeInsets.all(32.0),
					child: Column(
						mainAxisAlignment: MainAxisAlignment.center,
						crossAxisAlignment: CrossAxisAlignment.stretch,
						children: <Widget>[
							Icon(Icons.security, size: 80, color: theme.colorScheme.primary),
							const SizedBox(height: 16),
							
							Text(
								'ようこそ！マスターPINを設定',
								style: theme.textTheme.headlineMedium?.copyWith(
									fontWeight: FontWeight.bold,
									color: theme.colorScheme.primary,
								),
								textAlign: TextAlign.center,
							),
							const SizedBox(height: 16),
							const Text(
								'これはアプリケーションにロックをかけるために使用する、最も重要なPINです。',
								style: TextStyle(fontSize: 14),
								textAlign: TextAlign.center,
							),
							const SizedBox(height: 32),
							
							TextField(
								controller: _pinController,
								obscureText: true,
								keyboardType: TextInputType.number,
								maxLength: 4, 
								textAlign: TextAlign.center,
								style: const TextStyle(fontSize: 24, letterSpacing: 8),
								decoration: const InputDecoration(
									labelText: '4桁の新しいPIN',
									counterText: '',
									border: OutlineInputBorder(borderRadius: BorderRadius.all(Radius.circular(12))),
									prefixIcon: Icon(Icons.vpn_key),
								),
							),
							const SizedBox(height: 16),
							
							TextField(
								controller: _confirmPinController,
								obscureText: true,
								keyboardType: TextInputType.number,
								maxLength: 4, 
								textAlign: TextAlign.center,
								style: const TextStyle(fontSize: 24, letterSpacing: 8),
								decoration: const InputDecoration(
									labelText: '確認用PINコード',
									counterText: '',
									border: OutlineInputBorder(borderRadius: BorderRadius.all(Radius.circular(12))),
									prefixIcon: Icon(Icons.check_circle_outline),
								),
							),
							const SizedBox(height: 32),

							if (_errorMessage.isNotEmpty)
								Padding(
									padding: const EdgeInsets.only(bottom: 16),
									child: Text(
										_errorMessage,
										style: const TextStyle(color: Colors.red, fontWeight: FontWeight.bold),
										textAlign: TextAlign.center,
									),
								),

							ElevatedButton(
								onPressed: _isLoading ? null : _submitPinSetup,
								style: ElevatedButton.styleFrom(
									minimumSize: const Size(double.infinity, 50),
									backgroundColor: theme.colorScheme.primary,
									foregroundColor: theme.colorScheme.onPrimary,
									shape: RoundedRectangleBorder(borderRadius: BorderRadius.circular(8)),
									elevation: 4,
								),
								child: _isLoading 
									? const SizedBox(
										width: 24,
										height: 24,
										child: CircularProgressIndicator(color: Colors.white, strokeWidth: 3),
									  )
									: const Text('PINを設定して開始', style: TextStyle(fontSize: 16, fontWeight: FontWeight.bold)),
							),
						],
					),
				),
			),
		);
	}
}

----------------------------services\auth_service.dart----------------------------

// ファイルパス: lib/services/auth_service.dart
// 役割: 生体認証（Local Authentication）のロジックを管理するサービス

import 'package:flutter/material.dart';


class AuthService {

	Future<bool> checkBiometrics() async {
		debugPrint("AuthService: 生体認証が利用可能かチェック中...");
		return Future.value(true); 
	}

	Future<bool> authenticate() async {
		debugPrint("AuthService: 生体認証を実行中...");
		
		await Future.delayed(const Duration(milliseconds: 500));
		
		return true; 
	}
}

----------------------------services\generator.dart----------------------------

// ファイルパス: lib/services/generator.dart
// 役割: 強力なランダムパスワードを生成する静的サービス

import 'dart:math';

class PasswordGeneratorService {
	static const String _lowercase = 'abcdefghijklmnopqrstuvwxyz';
	static const String _uppercase = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
	static const String _numbers = '0123456789';
	static const String _symbols = '!@#\$%^&*()-_+=<>?/{}[]~';

	static String generatePassword({
		required int length,
		required bool useUpper,
		required bool useNumbers,
		required bool useSymbols,
	}) {
		if (length < 8) {
			length = 8;
		}

		String charSet = _lowercase;
		String mandatoryChars = '';

		if (useUpper) {
			charSet += _uppercase;
			mandatoryChars += _getRandomChar(_uppercase);
		}
		if (useNumbers) {
			charSet += _numbers;
			mandatoryChars += _getRandomChar(_numbers);
		}
		if (useSymbols) {
			charSet += _symbols;
			mandatoryChars += _getRandomChar(_symbols);
		}

		String password = mandatoryChars;

		final remainingLength = length - mandatoryChars.length;
		final random = Random.secure();
		
		for (int i = 0; i < remainingLength; i++) {
			password += charSet[random.nextInt(charSet.length)];
		}

		return _shuffle(password);
	}

	static String _getRandomChar(String set) {
		if (set.isEmpty) return '';
		final random = Random.secure();
		return set[random.nextInt(set.length)];
	}

	static String _shuffle(String text) {
		final List<String> characters = text.split('');
		final random = Random.secure();
		
		for (int i = characters.length - 1; i > 0; i--) {
			int j = random.nextInt(i + 1);
			final temp = characters[i];
			characters[i] = characters[j];
			characters[j] = temp;
		}
		return characters.join();
	}
}

----------------------------main.dart----------------------------

// ファイルパス: lib/main.dart
// 役割: アプリのエントリポイントと認証ラッパーの追加

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';
import 'screens/auth_screen.dart'; 
import 'screens/home_screen.dart'; 
import 'screens/setup_screen.dart'; 
import 'providers/auth_provider.dart'; 
import 'providers/master_pin_provider.dart'; 

void main() {
	runApp(
		const ProviderScope(
			child: App(),
		),
	);
}

class AuthWrapper extends ConsumerStatefulWidget {
	const AuthWrapper({super.key});

	@override
	ConsumerState<AuthWrapper> createState() => _AuthWrapperState();
}

class _AuthWrapperState extends ConsumerState<AuthWrapper> {
	
	@override
	Widget build(BuildContext context) {
		final isAuthenticated = ref.watch(authProvider);
        final isPinSet = ref.watch(masterPinProvider).isPinSet;
		
		if (!isPinSet) {
			return const SetupScreen(key: ValueKey('SetupScreen'));
		}
		if (isAuthenticated) {
			return const HomeScreen(key: ValueKey('HomeScreen'));
		} else {
			return const AuthScreen(key: ValueKey('AuthScreenLock'));
		}
	}
}

class App extends StatelessWidget {
	const App({super.key});

	@override
	Widget build(BuildContext context) {
		return MaterialApp(
			title: 'パスワードマネージャー',
			theme: ThemeData(
				colorScheme: ColorScheme.fromSeed(
					seedColor: const Color.fromARGB(255, 0, 70, 150),
					primary: const Color.fromARGB(255, 0, 70, 150),
					secondary: const Color.fromARGB(255, 0, 150, 180),
				),
				useMaterial3: true,
				fontFamily: 'Roboto', 
			),
			home: const AuthWrapper(),
		);
	}
}

----------------------------test\widget_test.dart----------------------------

// ファイルパス: test/widget_test.dart
// 役割: アプリケーションのウィジェットテスト

import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';

import 'package:flutter_application1/main.dart'; 

void main() {
  testWidgets('Renders the PIN screen initially', (WidgetTester tester) async {
    await tester.pumpWidget(const ProviderScope(child: App()));

    expect(find.text('マスターPINを設定/入力'), findsOneWidget);
    expect(find.byType(TextField), findsOneWidget);
    
    expect(find.text('パスワード一覧'), findsNothing);
  });
}

----------------------------pubspec.yaml----------------------------

name: flutter_application1
description: A secure password manager app prototype using Flutter and Riverpod.
publish_to: 'none' 

version: 1.0.0+1

environment:
  sdk: '>=3.3.0 <4.0.0'

dependencies:
  flutter:
    sdk: flutter
  
  flutter_riverpod: ^2.5.1
  
  local_auth: ^2.1.8
  
  collection: ^1.18.1 
  
  shared_preferences: ^2.2.2 

  flutter_secure_storage: ^9.0.0 
  
  uuid: ^4.3.1 

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^3.0.0

flutter:
  uses-material-design: true
